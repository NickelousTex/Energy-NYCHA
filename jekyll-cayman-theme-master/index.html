<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="UTF-8">
  <title>311 NYC</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#157878">
  <link rel="stylesheet" href="css/normalize.css">
  <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="css/cayman.css">
</head>

  <body>
    <section class="page-header">
  <h1 class="project-name">Fix It NYC</h1>
  <h2 class="project-tagline">Regression Predictions on NYC 311 Data</h2>
  <a href="https://github.com/NickelousTex/NYCHA_311_Capstone" class="btn">View on GitHub</a>
</section>
<!-Data intro>
    <section class="main-content">

      <div id="home">
  <h1>The Data:</h1>
  <ul class="posts">

Talk about Data, show 311 logo, picture of the Soda API, maybe the dashboard
  </ul>
</div>
<p>
<img src="images/nycopen.png" style=left;width:180px;height:140px;><img src="images/nyc311.jpg" style=left;width:180px;height:140px;><img src="images/socrata.png" style=left;width:180px;height:140px;>
</p>
</section>

<! Data Cleaning:>
    <section class="main-content">

      <div id="home">
  <h1> Data Mungeing:</h1>
  <ul class="posts">

As with most open data sets, there's a lot to explore and look through.
-some small code, perhaps colorized and small png graphs showing useful data.
<br>
<div>
<h4>How to get this:</h4>
<img src="images/uncleaned_data.png" style=left;width:180px;height:300px;>
</div>
<h4>To something more useful like this:</h4>
<img src="images/cleaned_data.png" style=;width:180px;height:140px;>
<p>
By lots of coding!

Issues along the way- an example:
<pre><code>print("Number of Community Boards: {}".format(api_df['community_board'].nunique()))
Number of Community Boards: 74
</pre></code>
<i>Note there are only 59 community boards in NYC!</i>
<pre><code>api_df_cleaned = api_df[api_df['community_board'].isin(community_board_list)]
Number of Community Boards: 59</code></pre>
  </ul>
</div>
</section>

<!-Initial Findings>
    <section class="main-content">

      <div id="home">
  <h1>Basic Info:</h1>
  <ul class="posts">
We can see a breakdown of calls by Borough
-Include calls over time, calls by borough
-Calls by agency, average time to close calls by agency
<div>
<iframe width="900" height="800" frameborder="0" scrolling="no" src="//plot.ly/dashboard/nickeloustex:22/embed"></iframe>
</div>
<div>
    <a href="https://plot.ly/~nickeloustex/20/?share_key=GY2HJXWzc5rtvlkI1xLVu8" target="_blank" title="histogram" style="display: block; "><img src="https://plot.ly/~nickeloustex/20.png?share_key=GY2HJXWzc5rtvlkI1xLVu8" alt="histogram" style="max-width: 100%;width: 600px;"  width="600" onerror="this.onerror=null;this.src='https://plot.ly/404.png';" /></a>
    <script data-plotly="nickeloustex:20" sharekey-plotly="GY2HJXWzc5rtvlkI1xLVu8" src="https://plot.ly/embed.js" async></script>style=left;width:180px;height:140px;
</div>


  </ul>
</div>
</section>

<!-Running Regression:>
    <section class="main-content">

      <div id="home">
  <h1>Regression Predicting</h1>
  <ul class="posts">
Random Forest & Gradient Boost models were picked because of their robustness to overfitting, as well as their ability to determin feature importance. Where Nueral Nets are black boxes.
<pre><code>random_forest = RandomForestRegressor()
random_forest.fit(X_train, y_train)
print('R2 score {}'.format(random_forest.score(X_test,y_test)))
R2 score 0.7741774171081134
</code></pre>
<img src="images/feature_importance_rf.png" alt=""> <p> Feature importance isn't particularly helpful overall at the moment as it tells us some of what we already know. What would be more useful is to verify complaints by agency type and work based upon that. What we're looking for is specific 'Ah-Ha' moments which are not present.
</p>
<p>
<pre><code>gradient_boost = GradientBoostingRegressor()
gradient_boost.fit(X_train, y_train)
print('R2 score {}'.format(gradient_boost.score(X_test,y_test)))
R2 score 0.7141774171081134
</code></pre>
<img src="images/feature_importance_gb.png" alt="">
</p>
-Finally show auto close results.
What drew attention was the feature importance of the created days & months. This lead to looking specifically if there is an auto close issue. It was found that while not consistent, there were calls being autoclosed.
  </ul>
</div>
</section>

<!-Tables of current info:>
    <section class="main-content">

      <div id="home">
  <h1>Current Predictions:</h1>
  <ul class="posts">
Predictions are generated every morning at 2:30 in the morning via an AWS EC2 instance. Results are saved as a .png file to be displayed here.
<br>
<h2>Today's predictions</h2>
-Insert PNG of current predictions
  <!-- <img src="images/crashed_dashboard.png" alt=""> -->
Current Comparision Results:
-And a PNG of predictions vs actual times
    <!-- <img src="images/crashed_dashboard.png" alt=""> -->

Results:
As you can see results can be hours off, while R*2 score is still at .77. Scoring is based on overall model prediction. When an issue that takes a week to resolve's prediction is also off by a week, this is a big miss. When an issue is resolved in 3 hours and predicted at 6 hours, this is not considered as poor as it's still resolved in a resonable time frame.
 </div>
</div>
</section>

<!-Building Dashboards>
    <section class="main-content">

      <div id="home">
  <h1>Data Dashboarding:</h1>
  <ul class="posts">

    <p>
    <img src="images/crashed_dashboard.png" alt="">
    </p>
Vizualization on OpenData is erratic at best. The dashboard can be displayed better with more enhanced options: we can create dashboards based upon specifically interesting events that occur:
<iframe width="900" height="800" frameborder="0" scrolling="no" src="//plot.ly/dashboard/nickeloustex:10/embed"></iframe>

<br>
<br>
<b>These dashboards can be created using SQL calls using the existing API:</b>
<pre><code>time = datetime.utcnow()-timedelta(days=7)
time_string = '{}-{}-{}T00:00:00.000'.format(time.year,time.month,time.day)
query = "created_date > '{}' AND complaint_type LIKE '%Homeless%' ".format(time_string)
results = client.get(database_311, select=select_sql, where=query, limit=100000)
</code></pre>


</section>

<!-Findings>
    <section class="main-content">

      <div id="home">
  <h1>Findings & Conclusion:</h1>
  <ul class="posts">

Auto closes are a paticular issue to be looked into. If this isn't a metric we should be rating on auto closed as this causes massive distorition to results.

  </ul>
</div>
</section>

<!-Next Steps>
    <section class="main-content">

      <div id="home">
  <h1>The Future:</h1>
  <ul class="posts">

Thoughts, requests, items of issue
-give thanks and include pictures of things used:
<h3>Here are some tools I used for this project:</h3>
<img src="images/amazon.png" style=left;width:180px;height:140px;">
<img src="images/dask.png" style=left;width:180px;height:140px;" >
<img src="images/plotly.png" style=left;width:180px;height:140px;">
<img src="images/sklearn.png" style=left;width:180px;height:140px;">
<img src="images/soda.png" style=left;width:180px;height:140px;">
<img src="images/spark.png" style=left;width:180px;height:140px;">
<img src="images/jekyll.png" style=left;width:180px;height:140px;">
<img src="images/numpy.png" style=left;width:180px;height:140px;">
<img src="images/sql.png" style=left;width:180px;height:140px;">
<img src="images/pandas.png" style=left;width:240x;height:140px;">
<img src="images/leaflet.png" style=left;width:240px;height:140px;">
  </ul>
</div>
</section>
    <footer class="site-footer">
<span class="site-footer-owner"><a href="https://github.com/NickelousTex/NYCHA_311_Capstone">311 NYC</a> is maintained by <a href="https://www.linkedin.com/in/nickeloustex/">Nick Teixeira</a>.</span>
<span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.</span>
</footer>

  </body>
</html>
